(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{429:function(t,a,s){t.exports=s.p+"assets/img/-1468486478980.f95e3b4a.png"},430:function(t,a,s){t.exports=s.p+"assets/img/-1468486797592.6e813cd7.png"},431:function(t,a,s){t.exports=s.p+"assets/img/-1468486844298.c139bcdf.png"},432:function(t,a,s){t.exports=s.p+"assets/img/-1468487682874.b57586da.png"},433:function(t,a,s){t.exports=s.p+"assets/img/-1468487792538.bb4f5d9e.png"},434:function(t,a,s){t.exports=s.p+"assets/img/-1468487434661.816473e2.png"},608:function(t,a,s){"use strict";s.r(a);var e=s(2),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"使用-jenkins-给-git-自动打-tag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-jenkins-给-git-自动打-tag"}},[t._v("#")]),t._v(" 使用 Jenkins 给 GIT 自动打 Tag")]),t._v(" "),a("h2",{attrs:{id:"使用-jenkins-给-git-自动打-tag-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-jenkins-给-git-自动打-tag-2"}},[t._v("#")]),t._v(" 使用 Jenkins 给 GIT 自动打 Tag")]),t._v(" "),a("p",[t._v("为了方便回滚代码，想给每次 Release 的代码打个 Tag。")]),t._v(" "),a("p",[t._v("希望可以在每次代码提交到 master 分支后就能够自动 tag。")]),t._v(" "),a("p",[t._v("这里介绍下使用 Jenkins 来实现这个自动打 Tag 的功能，主要是通过 "),a("strong",[t._v("GIT Publisher")]),t._v(" 这个插件来实现的。阅读下文之前，你需要安装好 Jenkins 以及 GIT Publisher 这个插件。")]),t._v(" "),a("h3",{attrs:{id:"配置-jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-jenkins"}},[t._v("#")]),t._v(" 配置 Jenkins")]),t._v(" "),a("h4",{attrs:{id:"配置-git-仓库的信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-git-仓库的信息"}},[t._v("#")]),t._v(" 配置 git 仓库的信息")]),t._v(" "),a("p",[t._v("填好仓库地址以及用户名密码")]),t._v(" "),a("p",[a("img",{attrs:{src:s(429),alt:"-1468486478980.png"}})]),t._v(" "),a("h4",{attrs:{id:"配置-git-publisher"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-git-publisher"}},[t._v("#")]),t._v(" 配置 GIT Publisher")]),t._v(" "),a("p",[t._v("配置好 git 仓库信息后，滚动到 Jenkins 的 配置页面最下方，找到 GIT Publisher 这个插件， 开始配置， 你可以看到下图。")]),t._v(" "),a("p",[a("img",{attrs:{src:s(430),alt:"-1468486797592.png"}})]),t._v(" "),a("p",[t._v("点击 “Add Tag”")]),t._v(" "),a("p",[a("img",{attrs:{src:s(431),alt:"-1468486844298.png"}})]),t._v(" "),a("p",[t._v("“Tag to Push”. 这个设置是指本次要打的 Tag 的名称。上图的例子中使用了 “BUILD_ID” 这个 Jenkins 提供的环境变量，最终打出的 Tag 会类似于 TAG-23。")]),t._v(" "),a("p",[t._v("注意：记得勾选 “Create new Tag”。")]),t._v(" "),a("h4",{attrs:{id:"自定义-tag-名称"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义-tag-名称"}},[t._v("#")]),t._v(" 自定义 Tag 名称")]),t._v(" "),a("p",[t._v("上文提到的 Tag 名称， 类似于 ” TAG-23”，并不能满足我的需求，我希望能使用日期+时间来定义 Tag 的名称，这样看起来就很清晰了，要实现这个，我们需要另一个插件的帮助。")]),t._v(" "),a("p",[t._v("BUILD_TIMESTAMP 这个插件提供一个环境变量，它使用了 Java 的日期 format 格式。安装好这个插件，在 Jenkins 配置页面的顶部可以看到它的配置。")]),t._v(" "),a("p",[a("img",{attrs:{src:s(432),alt:"-1468487682874.png"}})]),t._v(" "),a("p",[t._v("在配置项里填入自己想要的日期格式："),a("code",[t._v("yyyyMMdd-HHmmss")])]),t._v(" "),a("p",[t._v("然后在 Add Tag 配置里的 “Tag to Push” 项里使用这个环境变量就好啦。")]),t._v(" "),a("p",[a("img",{attrs:{src:s(433),alt:"-1468487792538.png"}})]),t._v(" "),a("h4",{attrs:{id:"其他功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他功能"}},[t._v("#")]),t._v(" 其他功能")]),t._v(" "),a("p",[t._v("GIT Publisher 处理提供 Add Tag 功能，还提供以下两个功能：")]),t._v(" "),a("p",[t._v("Add Branch")]),t._v(" "),a("p",[t._v("Add Note")]),t._v(" "),a("p",[t._v("你可以根据自己的需要进行配置。")]),t._v(" "),a("p",[a("img",{attrs:{src:s(434),alt:"-1468487434661.png"}})]),t._v(" "),a("h4",{attrs:{id:"触发-jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#触发-jenkins"}},[t._v("#")]),t._v(" 触发 Jenkins")]),t._v(" "),a("p",[t._v("上文的设置是没有提到如何在提交代码时触发 Jenkins 的 Build 的，这一块的可以看看这篇文章：")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://myfjdthink.com/2016/07/14/%E4%BD%BF%E7%94%A8-git-hooks-%E8%A7%A6%E5%8F%91-jenkins-%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A1/",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用-git-hooks-触发-jenkins-构建任务"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://www.benhallbenhall.com/2013/03/hudson-jenkins-create-git-tags-branches-automatically/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.benhallbenhall.com/2013/03/hudson-jenkins-create-git-tags-branches-automatically/"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);