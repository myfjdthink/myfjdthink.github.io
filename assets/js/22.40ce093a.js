(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{563:function(a,t,e){a.exports=e.p+"assets/img/1d77e5dc097360fa3c04bb7d91692cc6.1d77e5dc.png"},564:function(a,t,e){a.exports=e.p+"assets/img/8fead27307278325a8db123adb8c7691.8fead273.png"},565:function(a,t,e){a.exports=e.p+"assets/img/6acafb80cd904e9a02b8802f9d1fb106.6acafb80.png"},566:function(a,t,e){a.exports=e.p+"assets/img/e8b941c7ba6b6cfaf6ec39b7228a2632.e8b941c7.png"},567:function(a,t,e){a.exports=e.p+"assets/img/7e22ac8b9286c55af16b023c4721419d.7e22ac8b.png"},673:function(a,t,e){"use strict";e.r(t);var s=e(2),r=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"效果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#效果"}},[a._v("#")]),a._v(" 效果")]),a._v(" "),t("p",[a._v("WebStorm 对 Coverage 提供了原生支持，方便开发者快速预览哪些代码还没被测试覆盖到。如下图，左侧目录树有覆盖率的提示，右侧代码行数右侧，粉红色的代码就是没有被测试覆盖的代码，非常清晰。")]),a._v(" "),t("p",[t("img",{attrs:{src:e(563),alt:"1d77e5dc097360fa3c04bb7d91692cc6.png"}})]),a._v(" "),t("h2",{attrs:{id:"配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[a._v("#")]),a._v(" 配置")]),a._v(" "),t("p",[a._v("那么要如何配置呢？配置一个 Mocha Runner， 在右上角点击添加一个运行配置")]),a._v(" "),t("p",[t("img",{attrs:{src:e(564),alt:"8fead27307278325a8db123adb8c7691.png"}})]),a._v(" "),t("p",[a._v("具体配置如下")]),a._v(" "),t("p",[t("img",{attrs:{src:e(565),alt:"6acafb80cd904e9a02b8802f9d1fb106.png"}})]),a._v(" "),t("ul",[t("li",[a._v("Extra mocha options 是 mocha 运行需要的参数，-t 是超时时间，-r 是要额外引入的包，这里为了支持 typescript，引入了 ts-node; 你也可以在项目目录下添加一个 test/mocha.opts 文件来实现同样的配置，具体见 mocha 文档。")]),a._v(" "),t("li",[a._v("Test file patterns 就是 mocha 要测试的文件Runner")])]),a._v(" "),t("h2",{attrs:{id:"运行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行"}},[a._v("#")]),a._v(" 运行")]),a._v(" "),t("p",[a._v("配置完成后，有三种运行模式，普通RUN， Debug，和 Coverage，分别对应右侧的三个图标，点击用 Coverage 模式运行，就可以生成 Coverage 报告了。")]),a._v(" "),t("p",[a._v("如下图，我们可以知道 src 目录的测试覆盖是 78%")]),a._v(" "),t("p",[t("img",{attrs:{src:e(566),alt:"e8b941c7ba6b6cfaf6ec39b7228a2632.png"}})]),a._v(" "),t("h2",{attrs:{id:"原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[a._v("#")]),a._v(" 原理")]),a._v(" "),t("p",[a._v("到这里，大家可能会有个疑问，WebStorm 是怎么做的 Coverage 呢？观察一下 WebStorm 的输出内容，可以发现，实际上是用 nyc 这个非常流行的包实现的，关于 nyc 的其他信息，请"),t("a",{attrs:{href:"https://istanbul.js.org",target:"_blank",rel:"noopener noreferrer"}},[a._v("查阅官网"),t("OutboundLink")],1),a._v("。")]),a._v(" "),t("p",[t("img",{attrs:{src:e(567),alt:"7e22ac8b9286c55af16b023c4721419d.png"}})]),a._v(" "),t("p",[a._v("OK，只要几步配置，就完成覆盖率的展示了。")]),a._v(" "),t("h2",{attrs:{id:"快速配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速配置"}},[a._v("#")]),a._v(" 快速配置")]),a._v(" "),t("p",[a._v("为了方便大家更简单地实现覆盖率测试，akajs 为大家提供了一个后端项目模板，只要两个命令就可以生成项目骨架，并且已经配置好了 Coverage 所需的所有东西。")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("klg-init --type project-ts project-name\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("在生成的项目中，已经配置好了 mocha 和 nyc 所需的相关配置。直接执行")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("npm run test\nnpm run cov\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("即可")])])}),[],!1,null,null,null);t.default=r.exports}}]);